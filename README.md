# WeatherSensor

## Цель проекта

Изучение технологии gRPC, применение полнодуплексного стрима.

## Описание проекта

1. Сервис эмулятор погодных данных:

- сервис генерирует события от двух погодных датчиков;
- сервис реализовывает Grpc-сервис, который в потоковом режиме возвращает данных из датчиков;
- сервис реализовывает REST-метод, который возвращает текущие параметры датчиков;

2. Сервис-клиент обработки событий от сервиса-эмулятора погодных датчиков:

- умеет подписываться на получение данных от конкретного датчика;
- умеет отписываться от получения информации от датчика;
- взаимодействует с сервисом-эмулятором через полнодуплексный grpc stream;
- умеет переподнимать поток, если происходит разрыв связи (например, если сервис-эмулятор остановлен, то необходимо пробовать подключаться к нему, до победного);
- должен оперативно агрегировать информацию в следующих разрезах:
    * средняя температура по каждому датчику за 1 минуту;
    * средняя влажность по каждому датчику за 1 минуту;
    * максимальное и минимальное содержание CO2 по каждому датчику за 1 минуту.  
- реализует ручки для чтения агрегированных данных в разрезе указанного интервала;
- реализует ручку для диагностики, которая выводит все сохраненные данные по каждому датчику.

3. Ограничение: Не используются внешние хранилища данных, данные хранятся в оперативной памяти только на время работы сервиса.

## Ключевые слова

- .Net 6
- gRPC
- bidirectional stream
- publisher/subscriber pattern

## Порядок развертывания

1. Склонировать репозиторий:

    ```bash
    git clone https://github.com/v-blinov/WeatherSensor.git
    ```

2. Запустить сервис-эмулятор погодных данных:

    ```bash
    # Перейти в папку проекта

    cd src
    cd Weather.SensorService
    dotnet run

    ```

3. Запустить сервис-обработчик данных (в другом терминале)

    ```bash
    # Перейти в папку проекта

    cd src
    cd Weather.ProcessingService
    dotnet run
    ```

4. Swagger не подключен, адреса ручек:

    - Сервис-эмулятор:  
    https://localhost:7200

    - Сервис-обработчик:  
    https://localhost:7124

